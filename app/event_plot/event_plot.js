/**
 * Created by codaphillips on 4/18/15.
 */
angular.module('wikiMiner.event_plot',['wikiMiner.slider.services'])
.directive('eventPlot', ['timeBounds', function(timeBounds){
       return {
           restrict:'E',
           template:'<svg viewBox="0 0 100 10"></svg>',
           scope:{
               data:'='
           },
           link: function(scope, element, attr){
               scope.timeBounds = timeBounds;
               scope.sample_data = [{"warnings":{"query":{"*":"Formatting of continuation data will be changing soon. To continue using the current formatting, use the 'rawcontinue' parameter. To begin using the new format, pass an empty string for 'continue' in the initial query."}},"query-continue":{"revisions":{"rvcontinue":607533711}},"query":{"pages":{"3850":{"pageid":3850,"ns":0,"title":"Baseball","revisions":[{"revid":656151296,"parentid":656119593,"user":"Gap9551","comment":"/* Rules and gameplay */"},{"revid":656119593,"parentid":653408634,"user":"Caracaskid","comment":""},{"revid":653408634,"parentid":652824514,"user":"Erpert","comment":"This flows better, imo"},{"revid":652824514,"parentid":652824213,"user":"NawlinWiki","comment":"Reverted edits by [[Special:Contribs/Koopa24|Koopa24]] ([[User talk:Koopa24|talk]]) to last version by Jgf606"},{"revid":652824213,"parentid":648962790,"user":"Koopa24","comment":""},{"revid":648962790,"parentid":645815024,"user":"Jgf606","comment":""},{"revid":645815024,"parentid":645669563,"user":"Peter Isotalo","comment":"removed Europe from lead; \"niche appeal\" is not \"popular\""},{"revid":645669563,"parentid":645669308,"user":"WikiDan61","comment":"Reverted 2 pending edits by [[Special:Contributions/SteelDeadpool|SteelDeadpool]] to revision 644933017 by Aidan721: Revert addition of list. This article is about baseball in general, not about the US-Canada specific [[Major League Baseball]]. The list a"},{"revid":645669308,"parentid":645668665,"user":"SteelDeadpool","comment":"/* MLB Teams (Present Day) */"},{"revid":645668665,"parentid":644933017,"user":"SteelDeadpool","comment":"MLB Teams (Present Day)"},{"revid":644933017,"parentid":642690339,"user":"Aidan721","comment":""},{"revid":642690339,"parentid":640792407,"user":"BattyBot","comment":"/* External links */Added [[:Category:Articles containing video clips]] & [[WP:AWB/GF|general fixes]] using [[Project:AWB|AWB]] (10741)"},{"revid":640792407,"parentid":640580678,"user":"Stevietheman","comment":"/* Pitching and fielding tactics */clean up articles linked from [[Louisville, Kentucky]] for [[Wikipedia:WikiProject Louisville]] using [[Project:AWB|AWB]]"},{"revid":640580678,"parentid":639889279,"user":"Giants2008","comment":"Little more on playoff expansion"},{"revid":639889279,"parentid":639719407,"user":"Giants2008","comment":"/* No clock to kill */ Update on MLB game length"},{"revid":639719407,"parentid":639279738,"user":"Dexbot","comment":"Removing Link FA template ([[d:Wikidata:Development plan#Badges|handled by wikidata]]) - The interwiki article is not featured"},{"revid":639279738,"parentid":638806282,"user":"Giants2008","comment":"/* Individual focus */ This was also mentioned in WikiProject newsletter; soften POV a bit"},{"revid":638806282,"parentid":638675575,"user":"Rks13","comment":"Update to reflect merge and rearrangement of Inning pages"},{"revid":638675575,"parentid":630778822,"user":"Giants2008","comment":"/* Baseball in popular culture */ Modify sentence mentioned as troublesome in baseball WikiProject newsletter"},{"revid":630778822,"parentid":630343484,"user":"Tyman222","comment":"Incorrect history"},{"revid":630343484,"parentid":627892912,"user":"Dale Arnett","comment":"Infobox: Updated governing body. Also, the Dominican league is a winter league, but isn't branded as such."},{"revid":627892912,"parentid":627787695,"user":"Joefromrandb","comment":"/* Rise of Ruth and racial integration */ ce"},{"revid":627787695,"parentid":627702583,"user":"Kanetama","comment":"/* Popularity and cultural impact */"},{"revid":627702583,"parentid":627528868,"user":"Matanya","comment":"/* Strategy and tactics */ +video"},{"revid":627528868,"parentid":627301000,"user":"Scoop2159","comment":"Hyperlinked book name in Sources"},{"revid":627301000,"parentid":627114261,"user":"Stevietheman","comment":"clean up articles linked from [[Louisville, Kentucky]] for [[Wikipedia:WikiProject Louisville]] using [[Project:AWB|AWB]]"},{"revid":627114261,"parentid":627113991,"user":"Scoop2159","comment":""},{"revid":627113991,"parentid":627113657,"user":"Scoop2159","comment":"/* Further reading */"},{"revid":627113657,"parentid":627113314,"user":"Scoop2159","comment":"/* Sources */"},{"revid":627113314,"parentid":627113208,"user":"Scoop2159","comment":"/* Pitching and fielding tactics */"},{"revid":627113208,"parentid":627111573,"user":"Scoop2159","comment":"Added a sentence telling that the manner of a pitcher's grip and release cause the ball to break as it approaches the batter, resulting in the different types of pitches mentioned."},{"revid":627111573,"parentid":627111345,"user":"Scoop2159","comment":"Added a sentence about the balk rule that limits pickoff attempts."},{"revid":627111345,"parentid":626191309,"user":"Scoop2159","comment":""},{"revid":626191309,"parentid":625453109,"user":"Cyberbot II","comment":"Tagging page with PC1 protection template. ([[en:WP:PEACHY|Peachy 2.0 (alpha 8)]])"},{"revid":625453109,"parentid":624813747,"user":"Redrose64","comment":"/* top */ fixup prot template"},{"revid":624813747,"parentid":624813679,"user":"Flyer22","comment":"Reverted edits by [[Special:Contribs/Zhikkon|Zhikkon]] ([[User talk:Zhikkon|talk]]) to last version by Dexbot"},{"revid":624813679,"parentid":624117729,"user":"Zhikkon","comment":""},{"revid":624117729,"parentid":623943780,"user":"Dexbot","comment":"Removing Link FA template ([[d:Wikidata:Development plan#Badges|handled by wikidata]])"},{"revid":623943780,"parentid":623786407,"user":"Dexbot","comment":"Removing Link GA template ([[d:Wikidata:Development plan#Badges|handled by wikidata]])"},{"revid":623786407,"parentid":623768159,"user":"Dexbot","comment":"Bot: Removing Link FA template"},{"revid":623768159,"parentid":623748823,"user":"Materialscientist","comment":"Reverted edits by [[Special:Contribs/Dexbot|Dexbot]] ([[User talk:Dexbot|talk]]) to last version by KAVEBEAR"},{"revid":623748823,"parentid":619090648,"user":"Dexbot","comment":"Bot: Removing Link FA template"},{"revid":619090648,"parentid":619090521,"user":"KAVEBEAR","comment":"(Script) [[commons:COM:FR|File renamed]]: [[File:Alexander Cartwright, photography by J. J. Williams (PP-69-3-005).jpg]] \u2192 [[File:Alexander Cartwright, photograph by J. J. Williams (PP-69-3-005).jpg]]"},{"revid":619090521,"parentid":618617922,"user":"KAVEBEAR","comment":"(Script) [[commons:COM:FR|File renamed]]: [[File:Alexander Cartwright Hawaii.jpg]] \u2192 [[File:Alexander Cartwright, photography by J. J. Williams (PP-69-3-005).jpg]]"},{"revid":618617922,"parentid":618095188,"user":"Illegitimate Barrister","comment":"/* Popularity and cultural impact */ new thumb"},{"revid":618095188,"parentid":616976675,"user":"Canuckian89","comment":"note about uncaught third strikes"},{"revid":616976675,"parentid":614677763,"user":"Cydebot","comment":"Robot - Removing category Olympic_recognised_sports per [[WP:CFD|CFD]] at [[Wikipedia:Categories for discussion/Log/2014 June 23]]."},{"revid":614677763,"parentid":614621710,"user":"Giants2008","comment":"/* Further reading */ Repair dead link"},{"revid":614621710,"parentid":614132501,"user":"Nickst","comment":"added [[Category:Olympic recognised sports]] using [[WP:HC|HotCat]]"},{"revid":614132501,"parentid":614122586,"user":"Meclee","comment":"removed [[Category:Global sports]] using [[WP:HC|HotCat]]un-cat"},{"revid":614122586,"parentid":614119731,"user":"Nickst","comment":"removed [[Category:Ball games]] using [[WP:HC|HotCat]] - already in subcat [[Category:Ball and bat games]]"},{"revid":614119731,"parentid":614118678,"user":"Nickst","comment":"new key for [[Category:Baseball]]: \" \" using [[WP:HC|HotCat]]"},{"revid":614118678,"parentid":613821361,"user":"Nickst","comment":"removed [[Category:Olympic sports]]; added [[Category:Former Summer Olympic sports]] using [[WP:HC|HotCat]]"},{"revid":613821361,"parentid":613507311,"user":"Meclee","comment":"added [[Category:Global sports]] using [[WP:HC|HotCat]]"},{"revid":613507311,"parentid":613343266,"user":"Mukogodo","comment":"/* Origins of baseball */ Antecedant unclear"},{"revid":613343266,"parentid":612635704,"user":"Giants2008","comment":"/* Popularity and cultural impact */ Rm tag; Internet Archive version works fine"},{"revid":612635704,"parentid":612632520,"user":"Y2kcrazyjoker4","comment":"copyedit"},{"revid":612632520,"parentid":612632168,"user":"Y2kcrazyjoker4","comment":"/* Attendance records and the age of steroids */"},{"revid":612632168,"parentid":612545773,"user":"Y2kcrazyjoker4","comment":"/* Rise of Ruth and racial integration */"},{"revid":612545773,"parentid":611969592,"user":"Y2kcrazyjoker4","comment":""},{"revid":611969592,"parentid":611690158,"user":"J 1982","comment":"why just this out of so many baseball categories?"},{"revid":611690158,"parentid":610476280,"user":"Kalki","comment":"/* External links */ {{wikiquote}}"},{"revid":610476280,"parentid":610304487,"user":"Jodosma","comment":"typo"},{"revid":610304487,"parentid":610304292,"user":"GoxSox1989","comment":"/* Origins of baseball */ correction"},{"revid":610304292,"parentid":609523194,"user":"GoxSox1989","comment":"correction"},{"revid":609523194,"parentid":609522863,"user":"Kelapstick","comment":"Changed protection level of Baseball: Persistent [[WP:Vandalism|vandalism]]: restoring indef semi, one month in April wasn't enough ([Edit=Allow only autoconfirmed users] (indefinite) [Move=Allow only administrators] (indefinite))"},{"revid":609522863,"parentid":609522777,"user":"Bruce1ee","comment":"Reverted 1 pending edit by [[Special:Contributions/170.24.134.18|170.24.134.18]] to revision 609522435 by Jamesx12345"},{"revid":609522777,"parentid":609522435,"user":"170.24.134.18","anon":"","comment":"I made it more efficient"},{"revid":609522435,"parentid":609522399,"user":"Jamesx12345","comment":"Reverted edits by [[Special:Contributions/170.24.134.18|170.24.134.18]] ([[User talk:170.24.134.18|talk]]) ([[WP:HG|HG 3]])"},{"revid":609522399,"parentid":609521975,"user":"170.24.134.18","anon":"","comment":""},{"revid":609521975,"parentid":609521959,"user":"ClueBot NG","comment":"Reverting possible vandalism by [[Special:Contributions/170.24.134.18|170.24.134.18]] to version by Qwfp. False positive? [[User:ClueBot NG/FalsePositives|Report it]]. Thanks, [[User:ClueBot NG|ClueBot NG]]. (1846943) (Bot)"},{"revid":609521959,"parentid":609429079,"user":"170.24.134.18","anon":"","comment":""},{"revid":609429079,"parentid":609424571,"user":"Qwfp","comment":"Reverted edits by [[Special:Contribs/173.167.0.45|173.167.0.45]] ([[User talk:173.167.0.45|talk]]) to last version by Gilo1969"},{"revid":609424571,"parentid":609409914,"user":"173.167.0.45","anon":"","comment":"/* Origins of baseball */"},{"revid":609409914,"parentid":609409429,"user":"Gilo1969","comment":"Reverted 1 pending edit by [[Special:Contributions/173.167.0.45|173.167.0.45]] to revision 609380223 by Prof. Mc"},{"revid":609409429,"parentid":609380223,"user":"173.167.0.45","anon":"","comment":""},{"revid":609380223,"parentid":609380008,"user":"Prof. Mc","comment":"Reverted 1 [[WP:AGF|good faith]] edit by [[Special:Contributions/66.220.214.65|66.220.214.65]] using [[WP:STiki|STiki]]"},{"revid":609380008,"parentid":609302684,"user":"66.220.214.65","anon":"","comment":""},{"revid":609302684,"parentid":609302671,"user":"ClueBot NG","comment":"Reverting possible vandalism by [[Special:Contributions/107.206.68.33|107.206.68.33]] to version by Katydidit. False positive? [[User:ClueBot NG/FalsePositives|Report it]]. Thanks, [[User:ClueBot NG|ClueBot NG]]. (1844459) (Bot)"},{"revid":609302671,"parentid":609156631,"user":"107.206.68.33","anon":"","comment":""},{"revid":609156631,"parentid":608723962,"user":"Katydidit","comment":"/* Rise of Ruth and racial integration */ foreign substances banned from the ball"},{"revid":608723962,"parentid":608719718,"user":"Farhan Khurram","comment":"Reverted 1 pending edit by [[Special:Contributions/164.104.242.60|164.104.242.60]] to revision 608631607 by Supernerd11: there is no strong evidence/source/reference provided neither I found on itnernet"},{"revid":608719718,"parentid":608631607,"user":"164.104.242.60","anon":"","comment":"/* History */"},{"revid":608631607,"parentid":608627347,"user":"Supernerd11","comment":"Reverted 1 pending edit by [[Special:Contributions/Flyingbooty775|Flyingbooty775]] to revision 608391402 by Waggers: Um, no"},{"revid":608627347,"parentid":608391402,"user":"Flyingbooty775","comment":""},{"revid":608391402,"parentid":608391334,"user":"Waggers","comment":"Reverted edits by [[Special:Contributions/208.108.81.182|208.108.81.182]] to last version by ClueBot NG ([[Wikipedia:Igloo|GLOO]])"},{"revid":608391334,"parentid":608375351,"user":"208.108.81.182","anon":"","comment":""},{"revid":608375351,"parentid":608375336,"user":"ClueBot NG","comment":"Reverting possible vandalism by [[Special:Contributions/Theoneandonlycamwow|Theoneandonlycamwow]] to version by Epicgenius. False positive? [[User:ClueBot NG/FalsePositives|Report it]]. Thanks, [[User:ClueBot NG|ClueBot NG]]. (1834517) (Bot)"},{"revid":608375336,"parentid":608262001,"user":"Theoneandonlycamwow","comment":""},{"revid":608262001,"parentid":608256847,"user":"Epicgenius","comment":"Reverted 1 [[WP:AGF|good faith]] edit by [[Special:Contributions/208.108.215.76|208.108.215.76]] using [[WP:STiki|STiki]] ([[User:Epicgenius/Terms and Conditions|Mistake?]] [[User talk:Epicgenius|Tell me.]])"},{"revid":608256847,"parentid":608246010,"user":"208.108.215.76","anon":"","comment":""},{"revid":608246010,"parentid":608245451,"user":"K6ka","comment":"Reverted edits by [[Special:Contributions/173.165.149.109|173.165.149.109]] ([[User talk:173.165.149.109|talk]]) to last revision by ClueBot NG ([[WP:HG|HG]])"},{"revid":608245451,"parentid":607959382,"user":"173.165.149.109","anon":"","comment":""},{"revid":607959382,"parentid":607959367,"user":"ClueBot NG","comment":"Reverting possible vandalism by [[Special:Contributions/96.252.225.139|96.252.225.139]] to version by 2001:5B0:23FF:3CF0:0:0:0:38. False positive? [[User:ClueBot NG/FalsePositives|Report it]]. Thanks, [[User:ClueBot NG|ClueBot NG]]. (1830729) (Bot)"},{"revid":607959367,"parentid":607861275,"user":"96.252.225.139","anon":"","comment":"/* Origins of baseball */"},{"revid":607861275,"parentid":607665361,"user":"2001:5B0:23FF:3CF0:0:0:0:38","anon":"","comment":"/* Rules and gameplay */"},{"revid":607665361,"parentid":607665317,"user":"Excirial","comment":"Reverted edits by [[Special:Contributions/Zenkai5|Zenkai5]] ([[User talk:Zenkai5|talk]]) ([[WP:HG|HG 3]])"},{"revid":607665317,"parentid":607664804,"user":"Zenkai5","comment":""},{"revid":607664804,"parentid":607533781,"user":"Zenkai5","comment":""},{"revid":607533781,"parentid":607533711,"user":"JayJasper","comment":"Reverted to revision 607329478 by [[Special:Contributions/ClueBot NG|ClueBot NG]] ([[User talk:ClueBot NG|talk]]). ([[WP:TW|TW]])"}]}}}}];
               var svg = d3.select(element[0].children[0])
                   .style('height', '100%')
                   .style('width','100%')
                   .style('min-width','100px');

               scope.$watch('timeBounds',function(newVal){
                   scope.render();
               },true);

               scope.render = function(){
                   console.log('Render');
                   var d = svg.selectAll('rect')
                       .data([scope.data])
                       .attr('x',function(x){return x.minTime})
                       .attr('width',function(x){return x.maxTime - x.minTime});

                   d.enter()
                       .append('rect')
                       .attr('x',function(x){return x.minTime})
                       .attr('y',0)
                       .attr('height',10)
                       .attr('width', function(x){return x.maxTime - x.minTime})
                       .style('fill','blue');

                   d.exit()
                       .remove();
               };

           }
       }
    }]);